import socket
import sys

ip = sys.argv[1]
porta = int(sys.argv[2])

servidor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
servidor.connect((ip, porta))

mensagem = servidor.recv(1024).decode()

senha = input(f"> {mensagem}: ")
servidor.send(senha.encode())

print(servidor.recv(1024).decode())

while True:
    dados_servidor = servidor.recv(1024)

    if dados_servidor.decode() == "< Conexão finalizada":
        print("\nConexão encerrada\n")
        servidor.close()
        break

    print(dados_servidor.decode())
    mensagem = input("> ")
    
    if mensagem == 'sair':
        servidor.send("\nConexão encerrada\n".encode())
        servidor.close()
        break
    mensagem += '\n'
    servidor.send(mensagem.encode())

