from scapy.all import IP, TCP, sr, L3RawSocket, conf,RandShort

host = "127.0.0.1"
porta = 8080

conf.L3socket = L3RawSocket

pacote_ip = IP(dst=host)
segmento_tcp = TCP(
    dport=porta,
    sport= RandShort(),
    flags= 'S',
    seq=1000,
    options=[('MSS',1460),("NOP",None),("WScale",7)]
)

resposta, semresp = sr(pacote_ip/segmento_tcp,timeout=1)

print(f"\n{resposta[0][0]}\n")


if resposta:
    for enviado, recebido in resposta:
        print(f"***recedido {recebido}\n")
        print(f"***enviado {enviado}\n")

        '''
        if recebido.haslayer(TCP):
            if recebido(TCP).flags == 0x012:
                print("Porta aberta")
            else:
                print("Porta fechada")
else:
    print("Porta filtrada")
    '''