import socket
import sys
import json


def DNSipv4(dominio_montado):
    try:
        dados = socket.getaddrinfo(dominio_montado, None, socket.AF_INET)
        IP = dados[1][4][0]

        print(f"{dominio_montado}\t\t- {IP}")
        return IP
    except socket.gaierror:
        return 0

def DNSipv6(dominio_montado):
    try:
        dados = socket.getaddrinfo(dominio_montado, None, socket.AF_INET6)
        IP = dados[1][4][0]

        print(f"{dominio_montado}\t\t- {IP}")

        return IP
    except socket.gaierror:
        return 0

resolvidos = []
dominios4 = {}
dominios6 = {}
registros_completos = {}

dominio = sys.argv[1]
with open (sys.argv[2]) as wordlist:

    for i in wordlist.readlines():
        i = i.replace('\n',"")
        dominio_montado = f"{i}.{dominio}"

        if dominio_montado not in resolvidos:

            IPv4 = DNSipv4(dominio_montado)
            IPv6 = DNSipv6(dominio_montado)

            resolvidos.append(dominio_montado)

            if IPv4 != 0:
                dominios4[dominio_montado] = IPv4
            if IPv6 != 0:
                dominios6[dominio_montado] = IPv6

registros_completos['IPv4'] = dominios4
registros_completos['IPv6'] = dominios6

registros_JSON = json.dumps(registros_completos)
with open(f"{dominio}-subdomains.json", 'w') as f:
    f.write(registros_JSON)

        
      
  
        


