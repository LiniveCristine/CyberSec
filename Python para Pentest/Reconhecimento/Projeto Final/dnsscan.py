import sys
import dnsclass

dominio = sys.argv[1]
tipo_resol = sys.argv[2]

help = """ dnsscan.py USO

python3 dnsscan.py dominio -sub wordlist.txt #subdomain bruteforce
python3 dnsscan.py dominio -cname wordlist.txt #cname bruteforce
python3 dnsscan.py dominio -sc wordlist.txt #subdomain e cname bruteforce
python3 dnsscan.py dominio -whois #consulta whois
"""

if tipo_resol == "-sub":
    wordlist = sys.argv[3]

    print("\nSubdomain bruteforce iniciando...\n")
    dns_resol = dnsclass.Dnsscan.subdomain_bruteforce(dominio,wordlist)
    
elif tipo_resol == "-cname":
    wordlist = sys.argv[3]

    print("\ncname bruteforce iniciando...")
    dns_resol = dnsclass.Dnsscan.cname_bruteforce(dominio,wordlist)

elif tipo_resol == "-sc":
    wordlist = sys.argv[3]

    print("Subdomain bruteforce iniciando...\n")
    dns_resol = dnsclass.Dnsscan.subdomain_bruteforce(dominio,wordlist)

    print("\ncname bruteforce iniciando...")
    dns_resol = dnsclass.Dnsscan.cname_bruteforce(dominio,wordlist)

elif tipo_resol == "-whois":
    print("Iniciando consulta whois...")
    consulta_whois = dnsclass.Dnsscan.consulta_whois(dominio)


elif tipo_resol == '-h' or tipo_resol == '--help':
    print(help)