import sys
import dnsclass
import dnsmenu

dominio = sys.argv[1]
tipo_resol = sys.argv[2]

help = """ dnsscan.py USO

python3 dnsscan.py dominio -sub wordlist.txt #subdomain bruteforce
python3 dnsscan.py dominio -cname wordlist.txt #cname bruteforce
python3 dnsscan.py dominio -sc wordlist.txt #subdomain e cname bruteforce
python3 dnsscan.py dominio -whois #consulta whois
"""

menu = dnsmenu.Menu(dominio)

match tipo_resol:
    case "-sub":
        wordlist = sys.argv[3]

        print("\nSubdomain bruteforce iniciando...\n")
        dns_resol = dnsclass.Dnsscan.subdomain_bruteforce(dominio,wordlist)
    
    case "-cname":
        wordlist = sys.argv[3]

        print("\ncname bruteforce iniciando...")
        dns_resol = dnsclass.Dnsscan.cname_bruteforce(dominio,wordlist)

    case "-sc":
        wordlist = sys.argv[3]

        print("Subdomain bruteforce iniciando...\n")
        dns_resol = dnsclass.Dnsscan.subdomain_bruteforce(dominio,wordlist)

        print("\ncname bruteforce iniciando...")
        dns_resol = dnsclass.Dnsscan.cname_bruteforce(dominio,wordlist)

    case "-whois":
        print("Iniciando consulta whois...")
        consulta_whois = dnsclass.Dnsscan.consulta_whois(dominio)

    case _:
        print(help)

