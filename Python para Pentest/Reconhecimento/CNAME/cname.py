import dns.resolver
import sys
import time

dominio = sys.argv[1]

with open(sys.argv[2]) as wordlist:

    for i in wordlist.readlines():
        i = i.replace('\n',"")
        
        subdominio = f"{i}.{dominio}"

        while True:

            
            try:
                resposta = dns.resolver.resolve(subdominio,"CNAME")

                cname = resposta[0]
                print(f"{subdominio} - Ã© um alias para - {cname} ")
                break
            except dns.resolver.NoAnswer:
                break
            except dns.resolver.NXDOMAIN:
                break
            except dns.resolver.LifetimeTimeout:
                time.sleep(3)
            except dns.resolver.NoNameservers:
                None



